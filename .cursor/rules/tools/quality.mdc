---
description: 质量 & 校验要求
globs: []
alwaysApply: true
---
最近更新: 2025-09-18
# 质量守则

## 通用
- 所有注释中文；领域命名精确。
- 文件 / 模块聚焦单一职责；避免巨型类/函数。
- 任何新增能力：附最小用例 / 测试思路（即便伪代码）。

## 日志
- 仅关键路径、失败、边界条件；避免噪音与重复日志。
- 等级语义：TRACE/DEBUG/INFO/WARN/ERROR；INFO 以上默认结构化（键值）。
- 日志字段建议：timestamp | level | traceId | spanId | actor/userId | scene | keyArgs | result | costMs | errorType。
- 敏感字段必须脱敏（仅保留末 3~4 位或散列）。
- 禁止在热点循环内高频打印或打印大对象（使用摘要/计数）。

## 错误处理
- 不吞异常；转换或包装并携带上下文。
- 区分业务 vs 系统异常；必要时自定义异常类。
- 用户可见消息不得暴露敏感实现细节。

## 性能与扩展
- 评估算法复杂度(O 表示)；避免无界增长集合。
- 预留扩展点：接口/策略/配置，不过度抽象。

## 安全（视场景）
- 输入校验：长度 / 类型 / 枚举 / 危险字符。
- 不记录敏感信息到日志（密码、密钥、隐私）。

## 交付前自检清单
- [ ] 需求点全部覆盖（含边界）。
- [ ] README 已更新或创建。
- [ ] 编译 / 构建 / 基础测试通过。
- [ ] 关键异常路径演练过。
- [ ] 命名、注释、目录结构清晰。
- [ ] 无明显重复代码 / 死代码。
- [ ] 日志结构化且适度，无噪音；不含敏感信息。
- [ ] 关键链路具备可观测点：trace 覆盖 + 核心指标（QPS/Latency/ErrorRate）。
- [ ] 给出后续迭代建议（如有）。
